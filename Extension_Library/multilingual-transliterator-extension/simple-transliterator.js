// Pure Transliteration System - Phonetic conversion only
console.log('üåç Pure Transliteration System loaded - Phonetic conversion mode');

// Comprehensive transliteration maps (phonetic representation)
const transliterationMaps = {
    arabic: {
        // Basic letters
        'ÿß': 'a', 'ÿ®': 'b', 'ÿ™': 't', 'ÿ´': 'th', 'ÿ¨': 'j', 'ÿ≠': 'h', 'ÿÆ': 'kh',
        'ÿØ': 'd', 'ÿ∞': 'dh', 'ÿ±': 'r', 'ÿ≤': 'z', 'ÿ≥': 's', 'ÿ¥': 'sh', 'ÿµ': 's',
        'ÿ∂': 'd', 'ÿ∑': 't', 'ÿ∏': 'z', 'ÿπ': "'", 'ÿ∫': 'gh', 'ŸÅ': 'f', 'ŸÇ': 'q',
        'ŸÉ': 'k', 'ŸÑ': 'l', 'ŸÖ': 'm', 'ŸÜ': 'n', 'Ÿá': 'h', 'Ÿà': 'w', 'Ÿä': 'y',
        
        // Special forms and variations
        'ÿ©': 'ah', 'Ÿâ': 'a', 'ÿ°': "'", 'ÿ¶': "'", 'ÿ§': "w'", 'ÿ•': 'i', 'ÿ£': 'a',
        'ÿ¢': 'aa', 'ÿßŸÑ': 'al-', 'ŸÑÿß': 'la', 'ÿ™ÿß': 'ta', 'ÿ®ÿß': 'ba', 'ŸÖÿß': 'ma',
        'ŸÜÿß': 'na', 'ÿ±ÿß': 'ra', 'ÿ≥ÿß': 'sa', 'ŸÉÿß': 'ka', 'ŸÅÿß': 'fa', 'Ÿáÿß': 'ha',
        
        // Extended Arabic letters (for other languages using Arabic script)
        '⁄Ü': 'ch', 'Ÿæ': 'p', '⁄ò': 'zh', '⁄Ø': 'g', '⁄§': 'v', '⁄®': 'g', '⁄©': 'k',
        '€å': 'y', '€í': 'e', '⁄∫': 'n', '⁄ë': 'r', 'Ÿπ': 't', '⁄à': 'd', '⁄ë': 'r',
        '⁄æ': 'h', '€É': 'h', '€Ç': 'h', '€ì': 'e', '€ç': 'ey', '€ê': 'e', '⁄Å': 'dz',
        
        // Diacritics and markers
        'Ÿé': 'a', 'Ÿè': 'u', 'Ÿê': 'i', 'Ÿã': 'an', 'Ÿå': 'un', 'Ÿç': 'in',
        'Ÿí': '', 'Ÿë': '', 'Ÿ∞': 'a', 'Ÿ±': 'a', 'Ÿ≤': 'a', 'Ÿ≥': 'a', 'Ÿ¥': "'",
        'Ÿµ': 'a', 'Ÿ∂': 'w', 'Ÿ∑': 'u', 'Ÿ∏': 'y', 'Ÿπ': 't', 'Ÿ∫': 't', 'Ÿª': 'b',
        
        // Numbers (Eastern Arabic-Indic)
        'Ÿ†': '0', 'Ÿ°': '1', 'Ÿ¢': '2', 'Ÿ£': '3', 'Ÿ§': '4', 'Ÿ•': '5', 
        'Ÿ¶': '6', 'Ÿß': '7', 'Ÿ®': '8', 'Ÿ©': '9',
        
        // Extended numbers (Persian/Urdu variants)
        '€∞': '0', '€±': '1', '€≤': '2', '€≥': '3', '€¥': '4', '€µ': '5',
        '€∂': '6', '€∑': '7', '€∏': '8', '€π': '9',
        
        // Punctuation and symbols
        'ÿå': ', ', 'ÿõ': '; ', 'ÿü': '?', '¬´': '"', '¬ª': '"', 'ÿç': '%',
        'ÿé': '%o', 'ÿè': '%oo', 'ÿê': '', 'ÿë': '', 'ÿû': '***', 'ÿü': '?',
        'ÿÄ': '&', 'ÿÅ': '', 'ÿÇ': '', 'ÿÉ': '', 'ÿÑ': '', 'ÿÖ': '', 'ÿÜ': '',
        'ÿá': '', 'ÿà': '', 'ÿâ': '', 'ÿä': '', 'ÿã': 'af', 'ÿç': '%'
    },
    
    russian: {
        // Lowercase Cyrillic
        '–∞': 'a', '–±': 'b', '–≤': 'v', '–≥': 'g', '–¥': 'd', '–µ': 'e', '—ë': 'yo',
        '–∂': 'zh', '–∑': 'z', '–∏': 'i', '–π': 'y', '–∫': 'k', '–ª': 'l', '–º': 'm',
        '–Ω': 'n', '–æ': 'o', '–ø': 'p', '—Ä': 'r', '—Å': 's', '—Ç': 't', '—É': 'u',
        '—Ñ': 'f', '—Ö': 'kh', '—Ü': 'ts', '—á': 'ch', '—à': 'sh', '—â': 'shch',
        '—ä': "'", '—ã': 'y', '—å': "'", '—ç': 'e', '—é': 'yu', '—è': 'ya',
        
        // Uppercase Cyrillic
        '–ê': 'A', '–ë': 'B', '–í': 'V', '–ì': 'G', '–î': 'D', '–ï': 'E', '–Å': 'Yo',
        '–ñ': 'Zh', '–ó': 'Z', '–ò': 'I', '–ô': 'Y', '–ö': 'K', '–õ': 'L', '–ú': 'M',
        '–ù': 'N', '–û': 'O', '–ü': 'P', '–†': 'R', '–°': 'S', '–¢': 'T', '–£': 'U',
        '–§': 'F', '–•': 'Kh', '–¶': 'Ts', '–ß': 'Ch', '–®': 'Sh', '–©': 'Shch',
        '–™': "'", '–´': 'Y', '–¨': "'", '–≠': 'E', '–Æ': 'Yu', '–Ø': 'Ya',
        
        // Extended Cyrillic (for other Slavic languages)
        '—í': 'dj', '—ì': 'gj', '—î': 'ie', '—ï': 'dz', '—ñ': 'i', '—ó': 'yi', '—ò': 'j',
        '—ô': 'lj', '—ö': 'nj', '—õ': 'c', '—ú': 'kj', '—û': 'u', '—ü': 'dz',
        '–Ç': 'Dj', '–É': 'Gj', '–Ñ': 'Ie', '–Ö': 'Dz', '–Ü': 'I', '–á': 'Yi', '–à': 'J',
        '–â': 'Lj', '–ä': 'Nj', '–ã': 'C', '–å': 'Kj', '–é': 'U', '–è': 'Dz',
        
        // Old Cyrillic and rare letters
        '—ê': 'e', '—ë': 'yo', '—ù': 'i', '“Å': 'c', '“ã': 'n', '“ç': 'r', '“è': 'p',
        '“ë': 'g', '“ì': 'gh', '“ï': 'gh', '“ó': 'zh', '“ô': 'z', '“õ': 'q', '“ù': 'k',
        '“ü': 'k', '“°': 'q', '“£': 'ng', '“•': 'ng', '“ß': 'p', '“©': 'h', '“´': 's',
        '“≠': 't', '“Ø': 'u', '“±': 'u', '“≥': 'h', '“µ': 'ts', '“∑': 'ch', '“π': 'ch',
        '“ª': 'h', '“Ω': 'e', '“ø': 'ch', '”è': 'i', '”ë': 'a', '”ì': 'a', '”ï': 'ae',
        
        // Numbers (if in Cyrillic context)
        '‚Ññ': 'No.', '‚ÇΩ': 'rub'
    },
    
    japanese: {
        // Hiragana (basic syllables)
        '„ÅÇ': 'a', '„ÅÑ': 'i', '„ÅÜ': 'u', '„Åà': 'e', '„Åä': 'o',
        '„Åã': 'ka', '„Åç': 'ki', '„Åè': 'ku', '„Åë': 'ke', '„Åì': 'ko',
        '„Åå': 'ga', '„Åé': 'gi', '„Åê': 'gu', '„Åí': 'ge', '„Åî': 'go',
        '„Åï': 'sa', '„Åó': 'shi', '„Åô': 'su', '„Åõ': 'se', '„Åù': 'so',
        '„Åñ': 'za', '„Åò': 'ji', '„Åö': 'zu', '„Åú': 'ze', '„Åû': 'zo',
        '„Åü': 'ta', '„Å°': 'chi', '„Å§': 'tsu', '„Å¶': 'te', '„Å®': 'to',
        '„Å†': 'da', '„Å¢': 'ji', '„Å•': 'zu', '„Åß': 'de', '„Å©': 'do',
        '„Å™': 'na', '„Å´': 'ni', '„Å¨': 'nu', '„Å≠': 'ne', '„ÅÆ': 'no',
        '„ÅØ': 'ha', '„Å≤': 'hi', '„Åµ': 'fu', '„Å∏': 'he', '„Åª': 'ho',
        '„Å∞': 'ba', '„Å≥': 'bi', '„Å∂': 'bu', '„Åπ': 'be', '„Åº': 'bo',
        '„Å±': 'pa', '„Å¥': 'pi', '„Å∑': 'pu', '„Å∫': 'pe', '„ÅΩ': 'po',
        '„Åæ': 'ma', '„Åø': 'mi', '„ÇÄ': 'mu', '„ÇÅ': 'me', '„ÇÇ': 'mo',
        '„ÇÑ': 'ya', '„ÇÜ': 'yu', '„Çà': 'yo',
        '„Çâ': 'ra', '„Çä': 'ri', '„Çã': 'ru', '„Çå': 're', '„Çç': 'ro',
        '„Çè': 'wa', '„Çê': 'wi', '„Çë': 'we', '„Çí': 'wo', '„Çì': 'n',
        
        // Hiragana combinations with small characters
        '„Åç„ÇÉ': 'kya', '„Åç„ÇÖ': 'kyu', '„Åç„Çá': 'kyo',
        '„Åó„ÇÉ': 'sha', '„Åó„ÇÖ': 'shu', '„Åó„Çá': 'sho',
        '„Å°„ÇÉ': 'cha', '„Å°„ÇÖ': 'chu', '„Å°„Çá': 'cho',
        '„Å´„ÇÉ': 'nya', '„Å´„ÇÖ': 'nyu', '„Å´„Çá': 'nyo',
        '„Å≤„ÇÉ': 'hya', '„Å≤„ÇÖ': 'hyu', '„Å≤„Çá': 'hyo',
        '„Åø„ÇÉ': 'mya', '„Åø„ÇÖ': 'myu', '„Åø„Çá': 'myo',
        '„Çä„ÇÉ': 'rya', '„Çä„ÇÖ': 'ryu', '„Çä„Çá': 'ryo',
        '„Åé„ÇÉ': 'gya', '„Åé„ÇÖ': 'gyu', '„Åé„Çá': 'gyo',
        '„Åò„ÇÉ': 'ja', '„Åò„ÇÖ': 'ju', '„Åò„Çá': 'jo',
        '„Å≥„ÇÉ': 'bya', '„Å≥„ÇÖ': 'byu', '„Å≥„Çá': 'byo',
        '„Å¥„ÇÉ': 'pya', '„Å¥„ÇÖ': 'pyu', '„Å¥„Çá': 'pyo',
        
        // Small hiragana
        '„ÅÅ': 'a', '„ÅÉ': 'i', '„ÅÖ': 'u', '„Åá': 'e', '„Åâ': 'o',
        '„Å£': 'tsu', '„ÇÉ': 'ya', '„ÇÖ': 'yu', '„Çá': 'yo', '„Çé': 'wa',
        
        // Katakana (basic syllables)
        '„Ç¢': 'a', '„Ç§': 'i', '„Ç¶': 'u', '„Ç®': 'e', '„Ç™': 'o',
        '„Ç´': 'ka', '„Ç≠': 'ki', '„ÇØ': 'ku', '„Ç±': 'ke', '„Ç≥': 'ko',
        '„Ç¨': 'ga', '„ÇÆ': 'gi', '„Ç∞': 'gu', '„Ç≤': 'ge', '„Ç¥': 'go',
        '„Çµ': 'sa', '„Ç∑': 'shi', '„Çπ': 'su', '„Çª': 'se', '„ÇΩ': 'so',
        '„Ç∂': 'za', '„Ç∏': 'ji', '„Ç∫': 'zu', '„Çº': 'ze', '„Çæ': 'zo',
        '„Çø': 'ta', '„ÉÅ': 'chi', '„ÉÑ': 'tsu', '„ÉÜ': 'te', '„Éà': 'to',
        '„ÉÄ': 'da', '„ÉÇ': 'ji', '„ÉÖ': 'zu', '„Éá': 'de', '„Éâ': 'do',
        '„Éä': 'na', '„Éã': 'ni', '„Éå': 'nu', '„Éç': 'ne', '„Éé': 'no',
        '„Éè': 'ha', '„Éí': 'hi', '„Éï': 'fu', '„Éò': 'he', '„Éõ': 'ho',
        '„Éê': 'ba', '„Éì': 'bi', '„Éñ': 'bu', '„Éô': 'be', '„Éú': 'bo',
        '„Éë': 'pa', '„Éî': 'pi', '„Éó': 'pu', '„Éö': 'pe', '„Éù': 'po',
        '„Éû': 'ma', '„Éü': 'mi', '„É†': 'mu', '„É°': 'me', '„É¢': 'mo',
        '„É§': 'ya', '„É¶': 'yu', '„É®': 'yo',
        '„É©': 'ra', '„É™': 'ri', '„É´': 'ru', '„É¨': 're', '„É≠': 'ro',
        '„ÉØ': 'wa', '„É∞': 'wi', '„É±': 'we', '„É≤': 'wo', '„É≥': 'n',
        
        // Katakana combinations
        '„Ç≠„É£': 'kya', '„Ç≠„É•': 'kyu', '„Ç≠„Éß': 'kyo',
        '„Ç∑„É£': 'sha', '„Ç∑„É•': 'shu', '„Ç∑„Éß': 'sho',
        '„ÉÅ„É£': 'cha', '„ÉÅ„É•': 'chu', '„ÉÅ„Éß': 'cho',
        '„Éã„É£': 'nya', '„Éã„É•': 'nyu', '„Éã„Éß': 'nyo',
        '„Éí„É£': 'hya', '„Éí„É•': 'hyu', '„Éí„Éß': 'hyo',
        '„Éü„É£': 'mya', '„Éü„É•': 'myu', '„Éü„Éß': 'myo',
        '„É™„É£': 'rya', '„É™„É•': 'ryu', '„É™„Éß': 'ryo',
        '„ÇÆ„É£': 'gya', '„ÇÆ„É•': 'gyu', '„ÇÆ„Éß': 'gyo',
        '„Ç∏„É£': 'ja', '„Ç∏„É•': 'ju', '„Ç∏„Éß': 'jo',
        '„Éì„É£': 'bya', '„Éì„É•': 'byu', '„Éì„Éß': 'byo',
        '„Éî„É£': 'pya', '„Éî„É•': 'pyu', '„Éî„Éß': 'pyo',
        
        // Extended katakana for foreign words
        '„É¥': 'vu', '„É¥„Ç°': 'va', '„É¥„Ç£': 'vi', '„É¥„Çß': 've', '„É¥„Ç©': 'vo',
        '„Ç¶„Ç£': 'wi', '„Ç¶„Çß': 'we', '„Ç¶„Ç©': 'wo',
        '„ÉÜ„Ç£': 'ti', '„Éà„Ç•': 'tu', '„Éá„Ç£': 'di', '„Éâ„Ç•': 'du',
        '„Éï„Ç°': 'fa', '„Éï„Ç£': 'fi', '„Éï„Çß': 'fe', '„Éï„Ç©': 'fo',
        '„ÉÑ„Ç°': 'tsa', '„ÉÑ„Ç£': 'tsi', '„ÉÑ„Çß': 'tse', '„ÉÑ„Ç©': 'tso',
        '„Ç∑„Çß': 'she', '„Ç∏„Çß': 'je', '„ÉÅ„Çß': 'che',
        '„Ç§„Çß': 'ye', '„ÇØ„Ç°': 'kwa', '„Ç∞„Ç°': 'gwa',
        
        // Small katakana
        '„Ç°': 'a', '„Ç£': 'i', '„Ç•': 'u', '„Çß': 'e', '„Ç©': 'o',
        '„ÉÉ': 'tsu', '„É£': 'ya', '„É•': 'yu', '„Éß': 'yo', '„ÉÆ': 'wa',
        
        // Special katakana symbols
        '„Éº': '-', '„Éª': '¬∑', '„ÉΩ': "'", '„Éæ': '"',
        
        // Punctuation
        '„ÄÇ': '.', '„ÄÅ': ', ', 'Ôºü': '?', 'ÔºÅ': '!', 'Ôºö': ': ', 'Ôºõ': '; ',
        '„Äå': '"', '„Äç': '"', '„Äé': "'", '„Äè': "'", 'Ôºà': '(', 'Ôºâ': ')',
        'Ôºª': '[', 'ÔºΩ': ']', 'ÔΩõ': '{', 'ÔΩù': '}', '„Äà': '<', '„Äâ': '>',
        '„Ää': '<<', '„Äã': '>>', '„Äê': '[', '„Äë': ']', '„Äî': '(', '„Äï': ')',
        '„Äú': '~', '‚Äª': '*', '„Äá': 'o', '„Äí': 'T', '„ÄÖ': '"', '„Äª': '"'
    },
    
    chinese: {
        // Common characters with pinyin transliteration
        '‰Ω†': 'ni', 'Â•Ω': 'hao', 'Êàë': 'wo', 'ÊòØ': 'shi', 'ÁöÑ': 'de', 'Âú®': 'zai',
        'Êúâ': 'you', '‰ªñ': 'ta', 'Â•π': 'ta', 'ÂÆÉ': 'ta', '‰ª¨': 'men', '‰∏ç': 'bu',
        '‰∫Ü': 'le', '‰∏ä': 'shang', '‰∏ã': 'xia', '‰∏≠': 'zhong', 'ÂõΩ': 'guo',
        '‰∫∫': 'ren', 'Â§ß': 'da', 'Â∞è': 'xiao', 'Êù•': 'lai', 'Âéª': 'qu',
        'ËØ¥': 'shuo', 'ËØù': 'hua', 'Áúã': 'kan', 'Âê¨': 'ting', 'ÂêÉ': 'chi',
        'Âñù': 'he', 'Ê∞¥': 'shui', 'Ëå∂': 'cha', 'È•≠': 'fan', 'ËÇâ': 'rou',
        'Ëèú': 'cai', 'Èí±': 'qian', '‰π∞': 'mai', 'Âçñ': 'mai', 'Â≠¶': 'xue',
        'Ê†°': 'xiao', 'ËÄÅ': 'lao', 'Â∏à': 'shi', 'Â≠¶': 'xue', 'Áîü': 'sheng',
        '‰π¶': 'shu', 'ËΩ¶': 'che', 'Ë∑Ø': 'lu', 'ÂÆ∂': 'jia', 'Èó®': 'men',
        'ÂºÄ': 'kai', 'ÂÖ≥': 'guan', 'Ëµ∞': 'zou', 'Ë∑ë': 'pao', 'Âùê': 'zuo',
        
        // Extended vocabulary
        'Áà±': 'ai', 'Âá∫': 'chu', '‰πü': 'ye', '‰ºö': 'hui', 'ÂèØ': 'ke', '‰ª•': 'yi',
        'Ëøô': 'zhe', 'ÈÇ£': 'na', '‰ªÄ': 'shen', '‰πà': 'me', 'Êó∂': 'shi', 'ÂÄô': 'hou',
        'Âú∞': 'di', 'Êñπ': 'fang', 'Âπ¥': 'nian', 'Êúà': 'yue', 'Êó•': 'ri', 'Â§©': 'tian',
        '‰ªä': 'jin', 'Êòé': 'ming', 'Êò®': 'zuo', 'Êôö': 'wan', 'Êó©': 'zao', 'Âçà': 'wu',
        'Âæà': 'hen', 'Â§ö': 'duo', 'Â∞ë': 'shao', 'Âá†': 'ji', '‰∏™': 'ge', 'Âè™': 'zhi',
        '‰∏Ä': 'yi', '‰∫å': 'er', '‰∏â': 'san', 'Âõõ': 'si', '‰∫î': 'wu', 'ÂÖ≠': 'liu',
        '‰∏É': 'qi', 'ÂÖ´': 'ba', '‰πù': 'jiu', 'ÂçÅ': 'shi', 'Áôæ': 'bai', 'ÂçÉ': 'qian',
        '‰∏á': 'wan', '‰∫ø': 'yi', 'Èõ∂': 'ling', 'Á¨¨': 'di', 'Ê¨°': 'ci', 'Âõû': 'hui',
        
        // Family and relationships
        'Áà∏': 'ba', 'Â¶à': 'ma', 'ÂÑø': 'er', 'Â•≥': 'nv', 'Â≠ê': 'zi', 'Â≠©': 'hai',
        'Áî∑': 'nan', 'Â•≥': 'nv', 'Êúã': 'peng', 'Âèã': 'you', 'Âêå': 'tong', '‰∫ã': 'shi',
        'ËÄÅ': 'lao', 'Êùø': 'ban', 'Â¶ª': 'qi', 'Â§´': 'fu', 'Â©ö': 'hun', 'Âßª': 'yin',
        
        // Colors
        'Á∫¢': 'hong', 'ÈªÑ': 'huang', 'Ëìù': 'lan', 'Áªø': 'lv', 'ÁôΩ': 'bai', 'Èªë': 'hei',
        'ÁÅ∞': 'hui', 'Á¥´': 'zi', 'Á≤â': 'fen', 'Ê©ô': 'cheng', 'Ê£ï': 'zong',
        
        // Body parts
        'Â§¥': 'tou', 'Áúº': 'yan', 'Áùõ': 'jing', 'Èºª': 'bi', 'Âò¥': 'zui', 'ËÄ≥': 'er',
        'Êúµ': 'duo', 'Êâã': 'shou', 'ËÑö': 'jiao', 'ËÖø': 'tui', 'ÂøÉ': 'xin', 'ËÑë': 'nao',
        
        // Food and drink
        'Á±≥': 'mi', 'Èù¢': 'mian', 'ÂåÖ': 'bao', 'Ê±§': 'tang', 'È∏°': 'ji', 'È∏≠': 'ya',
        'È±º': 'yu', 'Ëôæ': 'xia', 'Ëüπ': 'xie', 'Êûú': 'guo', 'Ëãπ': 'ping', 'Ê¢®': 'li',
        'È¶ô': 'xiang', 'Ëïâ': 'jiao', 'Ëë°': 'pu', 'ËêÑ': 'tao', 'ÈÖí': 'jiu', 'Âíñ': 'ka',
        'Âï°': 'fei', 'Áâõ': 'niu', 'Â•∂': 'nai', 'Á≥ñ': 'tang', 'Áõê': 'yan', 'ÈÜã': 'cu',
        
        // Nature
        'Â±±': 'shan', 'Ê≤≥': 'he', 'Êµ∑': 'hai', 'Êπñ': 'hu', 'Ê†ë': 'shu', 'Ëä±': 'hua',
        'Ëçâ': 'cao', 'È∏ü': 'niao', 'Áãó': 'gou', 'Áå´': 'mao', 'È©¨': 'ma', 'Áæä': 'yang',
        'Áå™': 'zhu', 'È∏°': 'ji', 'È∏≠': 'ya', 'È±º': 'yu', 'Ëô´': 'chong', 'Ëõá': 'she',
        
        // Weather
        'Èõ®': 'yu', 'Èõ™': 'xue', 'È£é': 'feng', '‰∫ë': 'yun', 'Èõ∑': 'lei', 'Áîµ': 'dian',
        'Èò≥': 'yang', 'ÂÖâ': 'guang', 'ÂÜ∑': 'leng', 'ÁÉ≠': 're', 'Êöñ': 'nuan', 'Âáâ': 'liang',
        
        // Directions
        '‰∏ú': 'dong', 'Âçó': 'nan', 'Ë•ø': 'xi', 'Âåó': 'bei', 'Â∑¶': 'zuo', 'Âè≥': 'you',
        'Ââç': 'qian', 'Âêé': 'hou', 'Èáå': 'li', 'Â§ñ': 'wai', 'ÂÜÖ': 'nei', 'Ëæπ': 'bian',
        
        // Actions
        'ÂÅö': 'zuo', 'Â∑•': 'gong', '‰Ωú': 'zuo', 'Áù°': 'shui', 'Ëßâ': 'jiao', 'Ëµ∑': 'qi',
        'Â∫ä': 'chuang', 'Ê¥ó': 'xi', 'Êæ°': 'zao', 'Âà∑': 'shua', 'Áâô': 'ya', 'Á©ø': 'chuan',
        'Ë°£': 'yi', 'Êúç': 'fu', 'ËÑ±': 'tuo', 'Êà¥': 'dai', 'Â∏Ω': 'mao', 'Èûã': 'xie',
        
        // Transportation
        'È£û': 'fei', 'Êú∫': 'ji', 'ÁÅ´': 'huo', 'Ëàπ': 'chuan', 'Ëá™': 'zi', 'Ë°å': 'xing',
        'Êë©': 'mo', 'Êâò': 'tuo', 'Âú∞': 'di', 'ÈìÅ': 'tie', 'ÂÖ¨': 'gong', '‰∫§': 'jiao',
        
        // Technology
        'Áîµ': 'dian', 'ËÑë': 'nao', 'Êâã': 'shou', 'Êú∫': 'ji', 'Áîµ': 'dian', 'ËßÜ': 'shi',
        'ÁΩë': 'wang', 'Áªú': 'luo', 'Ê∏∏': 'you', 'Êàè': 'xi', 'Èü≥': 'yin', '‰πê': 'le',
        
        // Punctuation
        'Ôºå': ', ', '„ÄÇ': '.', 'Ôºü': '?', 'ÔºÅ': '!', 'Ôºö': ': ', 'Ôºõ': '; ',
        '\u201C': '"', '\u201D': '"', '\u2018': "'", '\u2019': "'", 'Ôºà': '(', 'Ôºâ': ')',
        '„Äê': '[', '„Äë': ']', '„Ää': '<<', '„Äã': '>>', '„ÄÅ': ', ', '¬∑': '¬∑'
    },
    
    korean: {
        // Basic Hangul consonants and vowels
        '„Ñ±': 'g', '„Ñ¥': 'n', '„Ñ∑': 'd', '„Ñπ': 'r', '„ÖÅ': 'm', '„ÖÇ': 'b', '„ÖÖ': 's',
        '„Öá': '', '„Öà': 'j', '„Öä': 'ch', '„Öã': 'k', '„Öå': 't', '„Öç': 'p', '„Öé': 'h',
        '„Ñ≤': 'kk', '„Ñ∏': 'tt', '„ÖÉ': 'pp', '„ÖÜ': 'ss', '„Öâ': 'jj',
        '„Öè': 'a', '„Öì': 'eo', '„Öó': 'o', '„Öú': 'u', '„Ö°': 'eu', '„Ö£': 'i',
        '„Öë': 'ya', '„Öï': 'yeo', '„Öõ': 'yo', '„Ö†': 'yu', '„Öí': 'yae', '„Öñ': 'ye',
        '„Öò': 'wa', '„Öô': 'wae', '„Öö': 'oe', '„Öù': 'wo', '„Öû': 'we', '„Öü': 'wi', '„Ö¢': 'ui',
        
        // Common Korean syllables and words
        'Ïïà': 'an', 'ÎÖï': 'nyeong', 'Ìïò': 'ha', 'ÏÑ∏': 'se', 'Ïöî': 'yo', 'Í∞ê': 'gam', 'ÏÇ¨': 'sa',
        'Ìï©': 'hap', 'Îãà': 'ni', 'Îã§': 'da', 'Îäî': 'neun', 'ÏùÑ': 'eul', 'Î•º': 'reul',
        'Ïù¥': 'i', 'Í∞Ä': 'ga', 'Ïóê': 'e', 'ÏÑú': 'seo', 'ÏôÄ': 'wa', 'Í≥º': 'gwa', 'Îòê': 'tto',
        'ÎÑ§': 'ne', 'ÏïÑ': 'a', 'Ïñ¥': 'eo', 'Ïò§': 'o', 'Ïö∞': 'u', 'Ïúº': 'eu', 'Ïùò': 'ui',
        
        // Numbers
        'Ìïò': 'ha', 'ÎÇò': 'na', 'Îëò': 'dul', 'ÏÖã': 'set', 'ÎÑ∑': 'net', 'Îã§': 'da', 'ÏÑØ': 'seot',
        'Ïó¨': 'yeo', 'ÏÑØ': 'seot', 'Ïùº': 'il', 'Í≥±': 'gop', 'Ïó¨': 'yeo', 'Îçü': 'deol',
        'ÏïÑ': 'a', 'Ìôâ': 'hop', 'Ïó¥': 'yeol'
    },
    
    hindi: {
        // Devanagari script
        '‡§Ö': 'a', '‡§Ü': 'aa', '‡§á': 'i', '‡§à': 'ii', '‡§â': 'u', '‡§ä': 'uu', '‡§è': 'e',
        '‡§ê': 'ai', '‡§ì': 'o', '‡§î': 'au', '‡§Ö‡§Ç': 'am', '‡§Ö‡§É': 'ah',
        '‡§ï': 'ka', '‡§ñ': 'kha', '‡§ó': 'ga', '‡§ò': 'gha', '‡§ô': 'nga',
        '‡§ö': 'cha', '‡§õ': 'chha', '‡§ú': 'ja', '‡§ù': 'jha', '‡§û': 'nya',
        '‡§ü': 'ta', '‡§†': 'tha', '‡§°': 'da', '‡§¢': 'dha', '‡§£': 'na',
        '‡§§': 'ta', '‡§•': 'tha', '‡§¶': 'da', '‡§ß': 'dha', '‡§®': 'na',
        '‡§™': 'pa', '‡§´': 'pha', '‡§¨': 'ba', '‡§≠': 'bha', '‡§Æ': 'ma',
        '‡§Ø': 'ya', '‡§∞': 'ra', '‡§≤': 'la', '‡§µ': 'va', '‡§∂': 'sha',
        '‡§∑': 'sha', '‡§∏': 'sa', '‡§π': 'ha', '‡§ï‡•ç‡§∑': 'ksha', '‡§§‡•ç‡§∞': 'tra', '‡§ú‡•ç‡§û': 'gya',
        
        // Diacritics (matras)
        '‡§æ': 'aa', '‡§ø': 'i', '‡•Ä': 'ii', '‡•Å': 'u', '‡•Ç': 'uu', '‡•á': 'e',
        '‡•à': 'ai', '‡•ã': 'o', '‡•å': 'au', '‡§Ç': 'm', '‡§É': 'h', '‡•ç': '',
        
        // Numbers
        '‡•¶': '0', '‡•ß': '1', '‡•®': '2', '‡•©': '3', '‡•™': '4', '‡•´': '5',
        '‡•¨': '6', '‡•≠': '7', '‡•Æ': '8', '‡•Ø': '9'
    },
    
    greek: {
        // Modern Greek alphabet
        'Œë': 'A', 'Œí': 'V', 'Œì': 'G', 'Œî': 'D', 'Œï': 'E', 'Œñ': 'Z', 'Œó': 'I',
        'Œò': 'Th', 'Œô': 'I', 'Œö': 'K', 'Œõ': 'L', 'Œú': 'M', 'Œù': 'N', 'Œû': 'X',
        'Œü': 'O', 'Œ†': 'P', 'Œ°': 'R', 'Œ£': 'S', 'Œ§': 'T', 'Œ•': 'Y', 'Œ¶': 'F',
        'Œß': 'Ch', 'Œ®': 'Ps', 'Œ©': 'O',
        'Œ±': 'a', 'Œ≤': 'v', 'Œ≥': 'g', 'Œ¥': 'd', 'Œµ': 'e', 'Œ∂': 'z', 'Œ∑': 'i',
        'Œ∏': 'th', 'Œπ': 'i', 'Œ∫': 'k', 'Œª': 'l', 'Œº': 'm', 'ŒΩ': 'n', 'Œæ': 'x',
        'Œø': 'o', 'œÄ': 'p', 'œÅ': 'r', 'œÉ': 's', 'œÇ': 's', 'œÑ': 't', 'œÖ': 'y',
        'œÜ': 'f', 'œá': 'ch', 'œà': 'ps', 'œâ': 'o',
        
        // Diacritics
        'Œ¨': 'a', 'Œ≠': 'e', 'ŒÆ': 'i', 'ŒØ': 'i', 'œå': 'o', 'œç': 'y', 'œé': 'o',
        'Œê': 'i', 'Œ∞': 'y', 'ŒÜ': 'A', 'Œà': 'E', 'Œâ': 'I', 'Œä': 'I', 'Œå': 'O',
        'Œé': 'Y', 'Œè': 'O'
    },
    
    hebrew: {
        // Hebrew alphabet
        '◊ê': "'", '◊ë': 'b', '◊í': 'g', '◊ì': 'd', '◊î': 'h', '◊ï': 'v', '◊ñ': 'z',
        '◊ó': 'ch', '◊ò': 't', '◊ô': 'y', '◊õ': 'k', '◊ú': 'l', '◊û': 'm', '◊ü': 'n',
        '◊†': 'n', '◊°': 's', '◊¢': "'", '◊§': 'p', '◊•': 'ts', '◊¶': 'ts', '◊ß': 'q',
        '◊®': 'r', '◊©': 'sh', '◊™': 't', '◊ö': 'k', '◊ù': 'm', '◊£': 'f',
        
        // Final forms
        '◊ö': 'kh', '◊ù': 'm', '◊ü': 'n', '◊£': 'f', '◊•': 'ts',
        
        // Nikud (vowel points)
        '÷∑': 'a', '÷∏': 'a', '÷∂': 'e', '÷µ': 'e', '÷¥': 'i', '÷π': 'o', '÷ª': 'u',
        '÷∞': '', '÷≤': 'a', '÷±': 'e', '÷≥': 'o', '÷º': '', '◊Å': '', '◊Ç': ''
    },
    
    thai: {
        // Thai consonants
        '‡∏Å': 'k', '‡∏Ç': 'kh', '‡∏Ñ': 'kh', '‡∏á': 'ng', '‡∏à': 'j', '‡∏â': 'ch', '‡∏ä': 'ch',
        '‡∏ã': 's', '‡∏ç': 'y', '‡∏î': 'd', '‡∏ï': 't', '‡∏ñ': 'th', '‡∏ó': 'th', '‡∏ò': 'th',
        '‡∏ô': 'n', '‡∏ö': 'b', '‡∏õ': 'p', '‡∏ú': 'ph', '‡∏ù': 'f', '‡∏û': 'ph', '‡∏ü': 'f',
        '‡∏†': 'ph', '‡∏°': 'm', '‡∏¢': 'y', '‡∏£': 'r', '‡∏•': 'l', '‡∏ß': 'w', '‡∏®': 's',
        '‡∏©': 's', '‡∏™': 's', '‡∏´': 'h', '‡∏¨': 'l', '‡∏≠': '', '‡∏Æ': 'h',
        
        // Thai vowels
        '‡∏∞': 'a', '‡∏≤': 'aa', '‡∏¥': 'i', '‡∏µ': 'ii', '‡∏∂': 'ue', '‡∏∑': 'uue',
        '‡∏∏': 'u', '‡∏π': 'uu', '‡πÄ': 'e', '‡πÅ': 'ae', '‡πÇ': 'o', '‡πÉ': 'ai', '‡πÑ': 'ai',
        
        // Thai numbers
        '‡πê': '0', '‡πë': '1', '‡πí': '2', '‡πì': '3', '‡πî': '4', '‡πï': '5',
        '‡πñ': '6', '‡πó': '7', '‡πò': '8', '‡πô': '9'
    }
};

function pureTransliterate(text, language) {
    const map = transliterationMaps[language];
    if (!map) return text;
    
    // Character-by-character transliteration
    return text.split('').map(char => {
        // Return transliterated character or original if no mapping
        return map[char] || char;
    }).join('');
}

function detectLanguage(text) {
    // Arabic script (Arabic, Persian, Urdu, etc.)
    if (/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/.test(text)) return 'arabic';
    
    // Cyrillic script (Russian, Bulgarian, Serbian, etc.)
    if (/[\u0400-\u04FF\u0500-\u052F\u2DE0-\u2DFF\uA640-\uA69F]/.test(text)) return 'russian';
    
    // Japanese scripts (Hiragana, Katakana, Kanji)
    if (/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FFF]/.test(text)) return 'japanese';
    
    // Chinese script (Simplified and Traditional)
    if (/[\u4E00-\u9FFF\u3400-\u4DBF]/.test(text)) return 'chinese';
    
    // Korean script (Hangul)
    if (/[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F]/.test(text)) return 'korean';
    
    // Devanagari script (Hindi, Sanskrit, Nepali, etc.)
    if (/[\u0900-\u097F]/.test(text)) return 'hindi';
    
    // Greek script
    if (/[\u0370-\u03FF\u1F00-\u1FFF]/.test(text)) return 'greek';
    
    // Hebrew script
    if (/[\u0590-\u05FF\uFB1D-\uFB4F]/.test(text)) return 'hebrew';
    
    // Thai script
    if (/[\u0E00-\u0E7F]/.test(text)) return 'thai';
    
    return null;
}

function processTextNode(textNode) {
    const originalText = textNode.textContent.trim();
    if (originalText.length === 0) return;
    
    const language = detectLanguage(originalText);
    if (!language) return;
    
    const parent = textNode.parentElement;
    if (!parent || parent.tagName === 'SCRIPT' || parent.tagName === 'STYLE') return;
    
    // Skip if already processed
    if (parent.dataset.transliterated) return;
    
    console.log(`üî§ Transliterating ${language}: "${originalText}"`);
    
    // Pure phonetic transliteration
    const transliteratedText = pureTransliterate(originalText, language);
    
    // Only proceed if text actually changed
    if (transliteratedText === originalText) {
        console.log(`‚ö†Ô∏è No transliteration needed for: "${originalText}"`);
        return;
    }
    
    // Replace the text content directly
    textNode.textContent = transliteratedText;
    
    // Mark as processed and add visual indicator
    parent.dataset.transliterated = 'true';
    parent.dataset.originalLanguage = language;
    parent.dataset.originalText = originalText;
    parent.style.backgroundColor = '#FFF3E0';
    parent.style.borderLeft = '4px solid #FF9800';
    parent.style.paddingLeft = '8px';
    parent.style.borderRadius = '2px';
    parent.style.fontStyle = 'italic';
    parent.title = `Transliterated from ${language.toUpperCase()}: "${originalText}" ‚Üí "${transliteratedText}"`;
    
    console.log(`‚úÖ Transliterated: "${originalText}" ‚Üí "${transliteratedText}"`);
}

function scanAndTransliterate() {
    if (!document.body) {
        setTimeout(scanAndTransliterate, 100);
        return;
    }
    
    console.log('üî§ Scanning page for transliteration...');
    
    const walker = document.createTreeWalker(
        document.body,
        NodeFilter.SHOW_TEXT,
        {
            acceptNode: (node) => {
                const parent = node.parentElement;
                if (!parent) return NodeFilter.FILTER_REJECT;
                if (parent.tagName === 'SCRIPT' || parent.tagName === 'STYLE') return NodeFilter.FILTER_REJECT;
                if (parent.dataset.transliterated) return NodeFilter.FILTER_REJECT;
                if (node.textContent.trim().length === 0) return NodeFilter.FILTER_REJECT;
                return NodeFilter.FILTER_ACCEPT;
            }
        }
    );
    
    const textNodes = [];
    let node;
    while (node = walker.nextNode()) {
        textNodes.push(node);
    }
    
    let transliteratedCount = 0;
    textNodes.forEach(textNode => {
        const beforeText = textNode.textContent;
        processTextNode(textNode);
        if (textNode.parentElement && textNode.parentElement.dataset.transliterated) {
            transliteratedCount++;
        }
    });
    
    console.log(`‚úÖ Transliteration complete. Processed ${transliteratedCount} text elements.`);
    
    // Add notification if any text was transliterated
    if (transliteratedCount > 0) {
        showTransliterationNotification(transliteratedCount);
    }
}

function showTransliterationNotification(count) {
    const notification = document.createElement('div');
    notification.innerHTML = `üî§ Transliteration: Converted ${count} text(s) to Latin script`;
    notification.style.cssText = `
        position: fixed;
        top: 10px;
        right: 10px;
        background: linear-gradient(45deg, #FF9800, #F57C00);
        color: white;
        padding: 12px 18px;
        border-radius: 8px;
        z-index: 999999;
        font-size: 14px;
        font-family: Arial, sans-serif;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        font-weight: bold;
        border: 2px solid #E65100;
    `;
    
    document.body.appendChild(notification);
    
    // Remove notification after 4 seconds
    setTimeout(() => {
        if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
        }
    }, 4000);
}

// Start processing
console.log('üöÄ Starting pure transliteration system...');

// Extension state management
let extensionEnabled = true;
let observer = null;

function initializeExtension() {
    if (extensionEnabled) {
        scanAndTransliterate();
        startObserver();
    }
}

function startObserver() {
    if (observer) {
        observer.disconnect();
    }
    
    observer = new MutationObserver((mutations) => {
        if (!extensionEnabled) return;
        
        let hasNewText = false;
        mutations.forEach((mutation) => {
            if (mutation.type === 'childList') {
                mutation.addedNodes.forEach((node) => {
                    if (node.nodeType === Node.TEXT_NODE || 
                        (node.nodeType === Node.ELEMENT_NODE && node.textContent.trim())) {
                        hasNewText = true;
                    }
                });
            }
        });
        
        if (hasNewText) {
            setTimeout(() => {
                if (extensionEnabled) {
                    scanAndTransliterate();
                }
            }, 100);
        }
    });
    
    observer.observe(document.body, {
        childList: true,
        subtree: true,
        characterData: true
    });
}

function stopExtension() {
    if (observer) {
        observer.disconnect();
        observer = null;
    }
    console.log('üõë Extension stopped - Transliteration paused');
}

function startExtension() {
    extensionEnabled = true;
    initializeExtension();
    console.log('üü¢ Extension started - Real-time transliteration active');
}

// Listen for messages from background/popup
chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
    console.log('üì® Content script received message:', request.action);
    
    switch (request.action) {
        case 'toggleTransliterator':
            extensionEnabled = request.enabled;
            if (extensionEnabled) {
                startExtension();
            } else {
                stopExtension();
            }
            sendResponse({ success: true, enabled: extensionEnabled });
            break;
            
        case 'getStatus':
            sendResponse({ enabled: extensionEnabled });
            break;
            
        case 'clearCache':
            // Remove all transliteration markers
            document.querySelectorAll('[data-transliterated]').forEach(element => {
                element.removeAttribute('data-transliterated');
                element.style.removeProperty('border-bottom');
                element.style.removeProperty('cursor');
            });
            console.log('üóëÔ∏è Cache cleared');
            sendResponse({ success: true });
            break;
            
        default:
            console.warn('‚ö†Ô∏è Unknown message action:', request.action);
    }
});

// Initialize extension
initializeExtension();